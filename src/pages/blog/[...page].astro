---
import { getCollection } from 'astro:content';
import type { GetStaticPaths, Page } from 'astro';
import ArticleView from '../../components/ArticleView.astro';
import Layout from '../../layouts/Layout.astro';
import { siteConfig } from '../../config';

type Articles = Awaited<ReturnType<typeof getCollection<"articles">>>;

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
	const articlesPerPage = siteConfig.articlesPerPage;
	const allArticles = await getCollection("articles");
	const sortedArticles = allArticles.sort((a, b) => a.data.date.getUTCFullYear() - b.data.date.getUTCFullYear()).reverse();

  return paginate(sortedArticles, {
    pageSize: articlesPerPage,
  })
}

interface Props {
	page: Page<Articles[number]>;
}

const { page }: Props = Astro.props;

const prevUrl = page.url.prev ? page.url.prev : "";
const nextUrl = page.url.next ? page.url.next : "";
---

<Layout title="Jeyhun Abbasov">
	<ArticleView prevUrl={prevUrl} nextUrl={nextUrl} articles={page.data}/>
</Layout>
